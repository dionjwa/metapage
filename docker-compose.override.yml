version: '2.3'

services:
  builder-haxe:
    command: just watch
    volumes:
     - ./docs:/docs
     - ./libs:/workspace

  test:
    command: ["/bin/sh", "-c", "nodemon --legacy-watch -e js,md --watch /docs/js --watch test --watch /docs/_metapages/test --watch /docs/_metaframes/test test/test.js"]

    volumes:
      - ./docs:/docs
      - ./libs/etc:/workspace/etc
      - ./libs/test:/workspace/test

  jekyll:
    volumes:
      - ./docs:/srv/jekyll

  # This is currently local to my personal setup, it's not ideal
  # but I need a better way of managing many many individual github project websites.
  # metapage-app:
  #   build:
  #     context: ../metapage-app/
  #   command: ["just", "serve"]
  #   volumes:
  #     - ${PWD}/../metapage-app:/workspace
  #   ports:
  #     - "4010:${PORT_METAPAGE_APP:-4010}"
  #   networks:
  #     - bridge
